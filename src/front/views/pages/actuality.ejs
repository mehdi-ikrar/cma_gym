<!DOCTYPE html>
<html lang="fr">
    <%- include('../partials/head') %>
<body>
    <div class="page-container">
        <%- include('../partials/header') %>
        
        <div class="content-wrapper">
            <!-- Barre de navigation latérale -->
            <%- include('../partials/sidebar') %>
            
            <!-- Contenu principal à droite -->
            <div class="main-content">
                <main>
                    <div class="container">
                        <!-- Fil d'Ariane -->
                        <section class="activities-hero">
                            <div class="activities-hero-content">
                                <h2 class="activities-hero-title">Toutes nos actualités</h2>
                                <p class="activities-hero-desc">
                                    Découvrez une sélection d'activités adaptées à tous les âges et tous les niveaux, encadrées par nos coachs passionnés.
                                </p>
                            </div>
                        </section>
                        
                        <article class="actuality-details">
                            <div class="actuality-header">
                                <h1 class="actuality-title"><%= actuality.title %></h1>
                                 <div class="actuality-meta">
                                    <span class="actuality-category">Actualité</span>
                                    <span class="actuality-category"><%= actuality.category ? actuality.category.title : 'Actualité' %></span>
                                    <span class="actuality-date"><i class="far fa-calendar-alt"></i> <%= new Date(actuality.createdAt).toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' }) %></span>
                                </div>

                            </div>
                            
                            <div class="actuality-hero">
                                <div class="actuality-image-container">
                                    <img src="/image/<%= actuality.image %>" alt="<%= actuality.title %>" class="actuality-image">
                                </div>
                                <div class="actuality-hero-overlay"></div>
                            </div>
                            
                            <div class="actuality-body">
                                <div class="actuality-content">
                                    <p class="actuality-description"><%= actuality.description %></p>
                                </div>
                                
                                <div class="actuality-footer">
                                    <div class="back-button">
                                        <a href="/actualities"><i class="fas fa-chevron-left"></i> Retour aux actualités</a>
                                    </div>

                                    <div class="actuality-actions">
                                        <% if (admin) { %>  <!-- Si admin est défini (connecté) -->
                                        <a href="/modifForm?id=<%= actuality.id %>" class="btn-edit" style="margin-right:10px;">
                                            <i class="fas fa-edit"></i> Modifier
                                        </a>
                                        <form action="/actualities/delete/<%= actuality.id %>" method="POST" style="display:inline;">
                                            <button type="submit" class="btn-delete" onclick="return confirm('Voulez-vous vraiment supprimer cette actualité ?');">
                                            <i class="fas fa-trash"></i> Supprimer
                                            </button>
                                        </form>
                                        <% } %>
                                        </div>
                                </div>
                            </div>
                        </article>
                        
                        <!-- Section des actualités connexes -->
                        <div class="related-news">
                            <h2 class="section-title">Autres actualités qui pourraient vous intéresser</h2>
                            <div class="related-news-grid">
                                <% if (sameCategoryActualities && sameCategoryActualities.length > 0) { %>
                                    <% sameCategoryActualities.forEach(function(item) { %>
                                        <% if (item.id !== actuality.id) { %>
                                        <div class="related-news-item">
                                            <a href="/actuality/<%= item.id %>" class="related-news-link">
                                                <div class="related-news-image-container">
                                                    <img src="/image/<%= item.image %>" alt="<%= item.title %>" class="related-news-image">
                                                </div>
                                                <h3 class="related-news-title"><%= item.title %></h3>
                                            </a>
                                        </div>
                                        <% } %>
                                    <% }); %>
                                <% } else { %>
                                    <p>Aucune autre actualité dans cette catégorie.</p>
                                <% } %>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        // Log côté client pour voir ce que tu reçois dans la vue
                        console.log('actuality:', <%- JSON.stringify(actuality) %>);
                        console.log('relatedActualities:', <%- JSON.stringify(relatedActualities) %>);
                        console.log('sameCategoryActualities:', <%- JSON.stringify(sameCategoryActualities) %>);
                    </script>
                </main>
            </div>
        </div>
        
        <%- include('../partials/footer') %>
    </div>
</body>
</html>

<style>
/* Styles rapides pour les boutons modifier/supprimer */
.actuality-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-left: 20px;
}
.btn-edit, .btn-delete {
    display: inline-flex;
    align-items: center;
    padding: 0.4rem 1rem;
    border-radius: 20px;
    font-size: 1rem;
    font-weight: 600;
    border: none;
    cursor: pointer;
    text-decoration: none;
    transition: background 0.2s, color 0.2s;
}
.btn-edit {
    background: linear-gradient(90deg, #ffa58f, #ff7e5f);
    color: #fff;
    border: none;
}
.btn-edit:hover {
    background: #ff7e5f;
    color: #fff;
}
.btn-delete {
    background: #fff;
    color: #e05642;
    border: 2px solid #e05642;
}
.btn-delete:hover {
    background: #e05642;
    color: #fff;
}
</style>